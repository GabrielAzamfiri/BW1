<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Timer</title>
    <link rel="stylesheet" href="reset.css" />
    <link rel="stylesheet" href="styletimer.css" />
  </head>
  <body>
    <div id="time">
      <div class="circle">
        <div class="dots secDot" style="--crl: grey"></div>
        <svg>
          <circle cx="70" cy="70" r="70" class="bg"></circle>
          <circle cx="70" cy="70" r="70" id="progress"></circle>
        </svg>
        <div class="seconds">
          <span class="span">seconds</span>
          <div id="timerSeconds">60</div>
          <span class="span">remaining</span>
        </div>
      </div>
    </div>
    <script>
      let progressCircle = document.getElementById("progress");
      let secDot = document.querySelector(".secDot");

      /* Funzione per il timer */
      let tempoRimanente = 60;
      const countdownElement = document.getElementById("timerSeconds");

      /* Imposto lo strokeDasharray per il cerchio */
      const lunghezzaCirconferenza = 440; // Circonferenza del cerchio
      progressCircle.style.strokeDasharray = lunghezzaCirconferenza;
      progressCircle.style.strokeDashoffset = lunghezzaCirconferenza;

      function aggiornamentoCountdown() {
        /* Decrementa il tempo rimanente */
        tempoRimanente--;

        /* Aggiorna il tempo */
        countdownElement.textContent = tempoRimanente;

        /* Calcolo lo strokeDashoffset in base al tempo rimanente */
        let percentualeCompletamento = tempoRimanente / 60;
        let strokeDashoffset =
          lunghezzaCirconferenza * percentualeCompletamento;
        progressCircle.style.strokeDashoffset = strokeDashoffset;

        /* Calcola l'angolo di rotazione per il puntino */
        let angoloRotazione = (60 - tempoRimanente) * 6;
        secDot.style.transform = `rotate(${angoloRotazione}deg)`;

        /* Se scade il tempo */
        if (tempoRimanente <= 0) {
          clearInterval(intervalloCountdown);
          questionResults();
        }
      }

      /* Impostiamo l'intervallo di aggiornamento del timer */
      const intervalloCountdown = setInterval(aggiornamentoCountdown, 1000);

      /* La funzione questionResults() è già stata stabilita da un collega */
    </script>
  </body>
</html>
